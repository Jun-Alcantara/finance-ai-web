openapi: 3.0.3
info:
  title: Finance AI API
  description: API for managing financial categories, bank accounts, and transactions
  version: 1.0.0
  contact:
    name: API Support

servers:
  - url: http://localhost:8000/api
    description: Local development server
  - url: https://api.example.com/api
    description: Production server

security:
  - bearerAuth: []

tags:
  - name: Categories
    description: Category management endpoints (user-scoped - each user has their own categories)
  - name: Bank Accounts
    description: Bank account management endpoints (user-scoped - each user has their own bank accounts)
  - name: Incomes
    description: Income management endpoints (user-scoped - each user has their own income records)

paths:
  /categories:
    get:
      tags:
        - Categories
      summary: List categories
      description: Retrieves a paginated list of the authenticated user's categories with optional search filtering
      operationId: listCategories
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          description: Page number to retrieve
          required: false
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: per_page
          in: query
          description: Items per page
          required: false
          schema:
            type: integer
            default: 15
            minimum: 1
            maximum: 100
        - name: search
          in: query
          description: Search term to filter categories by name
          required: false
          schema:
            type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Category'
                  meta:
                    $ref: '#/components/schemas/PaginationMeta'
                  links:
                    $ref: '#/components/schemas/PaginationLinks'
              example:
                data:
                  - id: "1"
                    name: "Food & Dining"
                    description: "Groceries, restaurants, and fast food"
                    created_at: "2024-01-01T00:00:00Z"
                    updated_at: "2024-01-01T00:00:00Z"
                meta:
                  current_page: 1
                  from: 1
                  last_page: 5
                  per_page: 15
                  to: 15
                  total: 75
                links:
                  first: "http://api.app.com/categories?page=1"
                  last: "http://api.app.com/categories?page=5"
                  prev: null
                  next: "http://api.app.com/categories?page=2"
        '401':
          $ref: '#/components/responses/Unauthorized'

    post:
      tags:
        - Categories
      summary: Create category
      description: Creates a new category for the authenticated user. Category names must be unique per user.
      operationId: createCategory
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CategoryInput'
            example:
              name: "Entertainment"
              description: "Movies, games..."
      responses:
        '201':
          description: Category created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Category'
              example:
                id: "4"
                name: "Entertainment"
                description: "Movies, games..."
                created_at: "2024-01-01T00:00:00Z"
                updated_at: "2024-01-01T00:00:00Z"
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/ValidationError'

  /categories/{id}:
    get:
      tags:
        - Categories
      summary: Get category
      description: Get a specific category by ID
      operationId: getCategory
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          description: Category ID
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Category'
              example:
                id: "1"
                name: "Food & Dining"
                description: "Groceries, restaurants, and fast food"
                created_at: "2024-01-01T00:00:00Z"
                updated_at: "2024-01-01T00:00:00Z"
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'

    put:
      tags:
        - Categories
      summary: Update category
      description: Updates an existing category
      operationId: updateCategory
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          description: Category ID
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CategoryInput'
            example:
              name: "Updated Name"
              description: "Updated Description"
      responses:
        '200':
          description: Category updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Category'
              example:
                id: "1"
                name: "Updated Name"
                description: "Updated Description"
                created_at: "2024-01-01T00:00:00Z"
                updated_at: "2024-01-01T00:00:00Z"
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'

    patch:
      tags:
        - Categories
      summary: Partially update category
      description: Partially updates an existing category
      operationId: patchCategory
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          description: Category ID
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CategoryPartialInput'
            example:
              name: "Updated Name"
      responses:
        '200':
          description: Category updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Category'
              example:
                id: "1"
                name: "Updated Name"
                description: "Original Description"
                created_at: "2024-01-01T00:00:00Z"
                updated_at: "2024-01-01T00:00:00Z"
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'

    delete:
      tags:
        - Categories
      summary: Delete category
      description: Deletes a category
      operationId: deleteCategory
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          description: Category ID
          required: true
          schema:
            type: string
      responses:
        '204':
          description: Category deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'

  /bank-accounts:
    get:
      tags:
        - Bank Accounts
      summary: List bank accounts
      description: Retrieves a paginated list of the authenticated user's bank accounts with optional search filtering by name or account number
      operationId: listBankAccounts
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          description: Page number to retrieve
          required: false
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: per_page
          in: query
          description: Items per page
          required: false
          schema:
            type: integer
            default: 15
            minimum: 1
            maximum: 100
        - name: search
          in: query
          description: Search term to filter by name or account number
          required: false
          schema:
            type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/BankAccount'
                  meta:
                    $ref: '#/components/schemas/PaginationMeta'
                  links:
                    $ref: '#/components/schemas/PaginationLinks'
              example:
                data:
                  - id: "uuid-1"
                    name: "Main Savings"
                    balance: "5000.00"
                    account_number: "1234567890"
                    created_at: "2024-01-01T00:00:00Z"
                    updated_at: "2024-01-01T00:00:00Z"
                meta:
                  current_page: 1
                  from: 1
                  last_page: 1
                  per_page: 15
                  to: 1
                  total: 1
                links:
                  first: "http://api.app.com/bank-accounts?page=1"
                  last: "http://api.app.com/bank-accounts?page=1"
                  prev: null
                  next: null
        '401':
          $ref: '#/components/responses/Unauthorized'

    post:
      tags:
        - Bank Accounts
      summary: Create bank account
      description: Creates a new bank account for the authenticated user
      operationId: createBankAccount
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BankAccountInput'
            example:
              name: "Daily Expenses"
              balance: 100.50
              account_number: "0987654321"
      responses:
        '201':
          description: Bank account created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BankAccount'
              example:
                id: "uuid-2"
                name: "Daily Expenses"
                balance: "100.50"
                account_number: "0987654321"
                created_at: "2024-01-02T00:00:00Z"
                updated_at: "2024-01-02T00:00:00Z"
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/ValidationError'

  /bank-accounts/{id}:
    get:
      tags:
        - Bank Accounts
      summary: Get bank account
      description: Get a specific bank account by ID
      operationId: getBankAccount
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          description: Bank Account ID
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BankAccount'
              example:
                id: "uuid-1"
                name: "Main Savings"
                balance: "5000.00"
                account_number: "1234567890"
                created_at: "2024-01-01T00:00:00Z"
                updated_at: "2024-01-01T00:00:00Z"
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/ForbiddenBankAccount'
        '404':
          $ref: '#/components/responses/NotFound'

    put:
      tags:
        - Bank Accounts
      summary: Update bank account
      description: Updates an existing bank account
      operationId: updateBankAccount
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          description: Bank Account ID
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BankAccountInput'
            example:
              name: "Updated Name"
              balance: 5500.00
      responses:
        '200':
          description: Bank account updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BankAccount'
              example:
                id: "uuid-1"
                name: "Updated Name"
                balance: "5500.00"
                account_number: "1234567890"
                created_at: "2024-01-01T00:00:00Z"
                updated_at: "2024-01-03T00:00:00Z"
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/ForbiddenBankAccount'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'

    patch:
      tags:
        - Bank Accounts
      summary: Partially update bank account
      description: Partially updates an existing bank account
      operationId: patchBankAccount
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          description: Bank Account ID
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BankAccountPartialInput'
            example:
              balance: 5500.00
      responses:
        '200':
          description: Bank account updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BankAccount'
              example:
                id: "uuid-1"
                name: "Main Savings"
                balance: "5500.00"
                account_number: "1234567890"
                created_at: "2024-01-01T00:00:00Z"
                updated_at: "2024-01-03T00:00:00Z"
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/ForbiddenBankAccount'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'

    delete:
      tags:
        - Bank Accounts
      summary: Delete bank account
      description: Soft deletes a bank account. The account is marked as deleted but not removed from the database.
      operationId: deleteBankAccount
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          description: Bank Account ID
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Bank account deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Bank account deleted successfully."
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/ForbiddenBankAccount'
        '404':
          $ref: '#/components/responses/NotFound'

  /incomes:
    get:
      tags:
        - Incomes
      summary: List incomes
      description: Retrieves a paginated list of the authenticated user's incomes with optional filtering. Results are ordered by date (nearest date first).
      operationId: listIncomes
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          description: Page number to retrieve
          required: false
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: per_page
          in: query
          description: Items per page
          required: false
          schema:
            type: integer
            default: 15
            minimum: 1
            maximum: 100
        - name: search
          in: query
          description: Search term to filter by remarks or category name
          required: false
          schema:
            type: string
        - name: start_date
          in: query
          description: Filter incomes from this date (inclusive)
          required: false
          schema:
            type: string
            format: date
        - name: end_date
          in: query
          description: Filter incomes until this date (inclusive)
          required: false
          schema:
            type: string
            format: date
        - name: received
          in: query
          description: Filter by received status
          required: false
          schema:
            type: boolean
        - name: is_recurring
          in: query
          description: Filter by recurring status
          required: false
          schema:
            type: boolean
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Income'
                  meta:
                    $ref: '#/components/schemas/PaginationMeta'
                  links:
                    $ref: '#/components/schemas/PaginationLinks'
              example:
                data:
                  - id: "uuid-1"
                    category_id: 1
                    category:
                      id: 1
                      name: "Salary"
                    bank_account_id: "uuid-ba-1"
                    bank_account:
                      id: "uuid-ba-1"
                      name: "Main Savings"
                      account_number: "1234567890"
                    amount: "5000.00"
                    remarks: "Monthly salary"
                    date: "2025-01-01"
                    received: false
                    is_recurring: true
                    recurring_type: "start_of_month"
                    recurring_day: null
                    recurring_group_id: "uuid-group-1"
                    recur_until: "2025-12-01"
                    can_edit: true
                    can_delete: true
                    created_at: "2024-12-01T00:00:00Z"
                    updated_at: "2024-12-01T00:00:00Z"
                meta:
                  current_page: 1
                  from: 1
                  last_page: 1
                  per_page: 15
                  to: 1
                  total: 1
                links:
                  first: "http://api.app.com/incomes?page=1"
                  last: "http://api.app.com/incomes?page=1"
                  prev: null
                  next: null
        '401':
          $ref: '#/components/responses/Unauthorized'

    post:
      tags:
        - Incomes
      summary: Create income
      description: Creates a new income record for the authenticated user. If recurring, automatically generates all income entries up to the recur_until date.
      operationId: createIncome
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IncomeInput'
            examples:
              simple:
                summary: Simple one-time income
                value:
                  category_id: 1
                  bank_account_id: "uuid-ba-1"
                  amount: 500.00
                  remarks: "Freelance work payment"
                  date: "2025-01-15"
                  received: false
              recurring_start_of_month:
                summary: Recurring income at start of month
                value:
                  category_id: 1
                  bank_account_id: "uuid-ba-1"
                  amount: 5000.00
                  remarks: "Monthly salary"
                  date: "2025-01-01"
                  received: false
                  is_recurring: true
                  recurring_type: "start_of_month"
                  recur_until: "2025-12-01"
              recurring_specific_date:
                summary: Recurring income on specific day
                value:
                  category_id: 1
                  bank_account_id: "uuid-ba-1"
                  amount: 5000.00
                  remarks: "Monthly salary"
                  date: "2025-01-15"
                  received: false
                  is_recurring: true
                  recurring_type: "specific_date"
                  recurring_day: 15
                  recur_until: "2025-12-15"
      responses:
        '201':
          description: Income created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Income'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/ValidationError'

  /incomes/{id}:
    get:
      tags:
        - Incomes
      summary: Get income
      description: Get a specific income by ID
      operationId: getIncome
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          description: Income ID
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Income'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/ForbiddenIncome'
        '404':
          $ref: '#/components/responses/NotFound'

    put:
      tags:
        - Incomes
      summary: Update income
      description: Updates an existing income. Only future and non-received incomes can be edited. Can optionally apply changes to all future recurring incomes.
      operationId: updateIncome
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          description: Income ID
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IncomeUpdateInput'
            examples:
              update_single:
                summary: Update single income
                value:
                  amount: 5500.00
                  remarks: "Updated salary amount"
                  apply_to_future: false
              update_all_future:
                summary: Update all future recurring incomes
                value:
                  amount: 5500.00
                  remarks: "Updated salary amount"
                  apply_to_future: true
      responses:
        '200':
          description: Income updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Income'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/ForbiddenIncomeEdit'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'

    patch:
      tags:
        - Incomes
      summary: Partially update income
      description: Partially updates an existing income. Only future and non-received incomes can be edited. Can optionally apply changes to all future recurring incomes.
      operationId: patchIncome
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          description: Income ID
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IncomePartialUpdateInput'
            example:
              amount: 5500.00
              apply_to_future: true
      responses:
        '200':
          description: Income updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Income'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/ForbiddenIncomeEdit'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'

    delete:
      tags:
        - Incomes
      summary: Delete income
      description: Deletes an income. Only future and non-received incomes can be deleted. Can optionally delete all future recurring incomes in the same group.
      operationId: deleteIncome
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          description: Income ID
          required: true
          schema:
            type: string
            format: uuid
        - name: apply_to_future
          in: query
          description: Whether to delete all future recurring incomes in the same group
          required: false
          schema:
            type: boolean
            default: false
      responses:
        '200':
          description: Income deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Income deleted successfully."
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/ForbiddenIncomeDelete'
        '404':
          $ref: '#/components/responses/NotFound'

  /incomes/{id}/mark-as-received:
    post:
      tags:
        - Incomes
      summary: Mark income as received
      description: Marks an income as received and updates the destination bank account balance
      operationId: markIncomeAsReceived
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          description: Income ID
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Income marked as received successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Income'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/ForbiddenIncome'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          description: Income is already marked as received
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Income is already marked as received."

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: Laravel Sanctum authentication token

  schemas:
    Category:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier
          example: "1"
        name:
          type: string
          description: Name of the category
          example: "Food & Dining"
        description:
          type: string
          nullable: true
          description: Description of the category
          example: "Groceries, restaurants, and fast food"
        created_at:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2024-01-01T00:00:00Z"
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp
          example: "2024-01-01T00:00:00Z"
      required:
        - id
        - name
        - created_at
        - updated_at

    CategoryInput:
      type: object
      properties:
        name:
          type: string
          description: Name of the category
          maxLength: 255
          example: "Entertainment"
        description:
          type: string
          nullable: true
          description: Description of the category
          example: "Movies, games, and other entertainment expenses"
      required:
        - name

    CategoryPartialInput:
      type: object
      properties:
        name:
          type: string
          description: Name of the category
          maxLength: 255
          example: "Entertainment"
        description:
          type: string
          nullable: true
          description: Description of the category
          example: "Movies, games, and other entertainment expenses"

    BankAccount:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier (UUID)
          example: "uuid-1"
        name:
          type: string
          description: Name of the bank account
          example: "Main Savings"
        balance:
          type: string
          description: Current balance of the account (formatted as string with 2 decimal places)
          example: "5000.00"
        account_number:
          type: string
          nullable: true
          description: Account number (optional)
          example: "1234567890"
        created_at:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2024-01-01T00:00:00Z"
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp
          example: "2024-01-01T00:00:00Z"
      required:
        - id
        - name
        - balance
        - created_at
        - updated_at

    BankAccountInput:
      type: object
      properties:
        name:
          type: string
          description: Name of the bank account
          maxLength: 255
          example: "Daily Expenses"
        balance:
          type: number
          format: decimal
          description: Current balance of the account
          example: 100.50
        account_number:
          type: string
          nullable: true
          description: Account number (optional)
          maxLength: 50
          example: "0987654321"
      required:
        - name
        - balance

    BankAccountPartialInput:
      type: object
      properties:
        name:
          type: string
          description: Name of the bank account
          maxLength: 255
          example: "Daily Expenses"
        balance:
          type: number
          format: decimal
          description: Current balance of the account
          example: 100.50
        account_number:
          type: string
          nullable: true
          description: Account number (optional)
          maxLength: 50
          example: "0987654321"

    Income:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier (UUID)
          example: "uuid-1"
        category_id:
          type: integer
          description: ID of the category
          example: 1
        category:
          type: object
          description: Category details
          properties:
            id:
              type: integer
              example: 1
            name:
              type: string
              example: "Salary"
        bank_account_id:
          type: string
          format: uuid
          description: ID of the destination bank account
          example: "uuid-ba-1"
        bank_account:
          type: object
          description: Bank account details
          properties:
            id:
              type: string
              format: uuid
              example: "uuid-ba-1"
            name:
              type: string
              example: "Main Savings"
            account_number:
              type: string
              nullable: true
              example: "1234567890"
        amount:
          type: string
          description: Income amount (formatted as string with 2 decimal places)
          example: "5000.00"
        remarks:
          type: string
          nullable: true
          description: Additional notes or remarks
          example: "Monthly salary payment"
        date:
          type: string
          format: date
          description: Date of the income
          example: "2025-01-01"
        received:
          type: boolean
          description: Whether the income has been received
          example: false
        is_recurring:
          type: boolean
          description: Whether this is a recurring income
          example: true
        recurring_type:
          type: string
          nullable: true
          enum: [specific_date, start_of_month, end_of_month]
          description: Type of recurrence (specific_date, start_of_month, or end_of_month)
          example: "start_of_month"
        recurring_day:
          type: integer
          nullable: true
          description: Day of the month for specific_date recurring type (1-31)
          example: 15
        recurring_group_id:
          type: string
          format: uuid
          nullable: true
          description: UUID linking recurring incomes together
          example: "uuid-group-1"
        recur_until:
          type: string
          format: date
          nullable: true
          description: End date for recurring income (only applicable for recurring incomes)
          example: "2025-12-01"
        can_edit:
          type: boolean
          description: Whether this income can be edited (only future and non-received incomes)
          example: true
        can_delete:
          type: boolean
          description: Whether this income can be deleted (only future and non-received incomes)
          example: true
        created_at:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2024-12-01T00:00:00Z"
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp
          example: "2024-12-01T00:00:00Z"
      required:
        - id
        - category_id
        - category
        - bank_account_id
        - bank_account
        - amount
        - date
        - received
        - is_recurring
        - can_edit
        - can_delete
        - created_at
        - updated_at

    IncomeInput:
      type: object
      properties:
        category_id:
          type: integer
          description: ID of the category
          example: 1
        bank_account_id:
          type: string
          format: uuid
          description: ID of the destination bank account
          example: "uuid-ba-1"
        amount:
          type: number
          format: decimal
          description: Income amount
          minimum: 0.01
          maximum: 999999999999.99
          example: 5000.00
        remarks:
          type: string
          nullable: true
          description: Additional notes or remarks
          maxLength: 5000
          example: "Monthly salary payment"
        date:
          type: string
          format: date
          description: Date of the income
          example: "2025-01-01"
        received:
          type: boolean
          description: Whether the income has been received (defaults to false)
          default: false
          example: false
        is_recurring:
          type: boolean
          description: Whether this is a recurring income (defaults to false)
          default: false
          example: true
        recurring_type:
          type: string
          nullable: true
          enum: [specific_date, start_of_month, end_of_month]
          description: Type of recurrence (required if is_recurring is true)
          example: "start_of_month"
        recurring_day:
          type: integer
          nullable: true
          description: Day of the month for specific_date recurring type (1-31, required if recurring_type is specific_date)
          minimum: 1
          maximum: 31
          example: 15
        recur_until:
          type: string
          format: date
          nullable: true
          description: End date for recurring income (required if is_recurring is true). All income entries will be automatically created up to this date.
          example: "2025-12-01"
      required:
        - category_id
        - bank_account_id
        - amount
        - date

    IncomeUpdateInput:
      type: object
      properties:
        category_id:
          type: integer
          description: ID of the category
          example: 1
        bank_account_id:
          type: string
          format: uuid
          description: ID of the destination bank account
          example: "uuid-ba-1"
        amount:
          type: number
          format: decimal
          description: Income amount
          minimum: 0.01
          maximum: 999999999999.99
          example: 5500.00
        remarks:
          type: string
          nullable: true
          description: Additional notes or remarks
          maxLength: 5000
          example: "Updated salary amount"
        date:
          type: string
          format: date
          description: Date of the income
          example: "2025-02-01"
        received:
          type: boolean
          description: Whether the income has been received
          example: false
        is_recurring:
          type: boolean
          description: Whether this is a recurring income
          example: true
        recurring_type:
          type: string
          nullable: true
          enum: [specific_date, start_of_month, end_of_month]
          description: Type of recurrence
          example: "start_of_month"
        recurring_day:
          type: integer
          nullable: true
          description: Day of the month for specific_date recurring type (1-31)
          minimum: 1
          maximum: 31
          example: 15
        recur_until:
          type: string
          format: date
          nullable: true
          description: End date for recurring income
          example: "2025-12-01"
        apply_to_future:
          type: boolean
          description: Whether to apply changes to all future recurring incomes in the same group (defaults to false)
          default: false
          example: true

    IncomePartialUpdateInput:
      type: object
      properties:
        category_id:
          type: integer
          description: ID of the category
          example: 1
        bank_account_id:
          type: string
          format: uuid
          description: ID of the destination bank account
          example: "uuid-ba-1"
        amount:
          type: number
          format: decimal
          description: Income amount
          minimum: 0.01
          maximum: 999999999999.99
          example: 5500.00
        remarks:
          type: string
          nullable: true
          description: Additional notes or remarks
          maxLength: 5000
          example: "Updated salary amount"
        date:
          type: string
          format: date
          description: Date of the income
          example: "2025-02-01"
        received:
          type: boolean
          description: Whether the income has been received
          example: false
        is_recurring:
          type: boolean
          description: Whether this is a recurring income
          example: true
        recurring_type:
          type: string
          nullable: true
          enum: [specific_date, start_of_month, end_of_month]
          description: Type of recurrence
          example: "start_of_month"
        recurring_day:
          type: integer
          nullable: true
          description: Day of the month for specific_date recurring type (1-31)
          minimum: 1
          maximum: 31
          example: 15
        recur_until:
          type: string
          format: date
          nullable: true
          description: End date for recurring income
          example: "2025-12-01"
        apply_to_future:
          type: boolean
          description: Whether to apply changes to all future recurring incomes in the same group (defaults to false)
          default: false
          example: true

    PaginationMeta:
      type: object
      properties:
        current_page:
          type: integer
          example: 1
        from:
          type: integer
          example: 1
        last_page:
          type: integer
          example: 5
        per_page:
          type: integer
          example: 15
        to:
          type: integer
          example: 15
        total:
          type: integer
          example: 75

    PaginationLinks:
      type: object
      properties:
        first:
          type: string
          nullable: true
          example: "http://api.app.com/categories?page=1"
        last:
          type: string
          nullable: true
          example: "http://api.app.com/categories?page=5"
        prev:
          type: string
          nullable: true
          example: null
        next:
          type: string
          nullable: true
          example: "http://api.app.com/categories?page=2"

    Error:
      type: object
      properties:
        message:
          type: string
          description: Error message
          example: "The given data was invalid."
        errors:
          type: object
          additionalProperties:
            type: array
            items:
              type: string
          description: Validation errors by field
          example:
            name:
              - "The name field is required."

  responses:
    Unauthorized:
      description: Unauthorized - Missing or invalid authentication token
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                example: "Unauthenticated."

    Forbidden:
      description: Forbidden - You don't have permission to access this resource
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                example: "This category does not belong to you."

    ForbiddenBankAccount:
      description: Forbidden - You don't have permission to access this bank account
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                example: "This bank account does not belong to you."

    ForbiddenIncome:
      description: Forbidden - You don't have permission to access this income
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                example: "This income does not belong to you."

    ForbiddenIncomeEdit:
      description: Forbidden - Income cannot be edited
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                example: "Received incomes cannot be edited."

    ForbiddenIncomeDelete:
      description: Forbidden - Income cannot be deleted
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                example: "Received incomes cannot be deleted."

    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                example: "Resource not found."

    ValidationError:
      description: Validation error - Invalid input data
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            message: "The given data was invalid."
            errors:
              name:
                - "The name field is required."
